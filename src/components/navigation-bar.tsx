import React, { useEffect, useState } from "react";
import { BottomNavigation, Icon, useNavigate } from "zmp-ui";
import { useLocation } from "react-router-dom";

const navItems = [
  {
    path: "/dashboard",
    label: "Dashboard",
    icon: <Icon icon="zi-more-grid" />,
    activeIcon: <Icon icon="zi-more-grid-solid" />,
  },
  {
    path: "/budget",
    label: "Budget",
    icon: (
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="20"
        viewBox="0 0 24 20"
        fill="none"
      >
        <path
          d="M11.9461 0.290527C7.48056 0.290527 3.58956 2.84653 2.46605 6.47803H1.64105C1.42237 6.47827 1.20638 6.52632 1.00822 6.61882C0.810064 6.71132 0.634528 6.84603 0.493911 7.01351C0.353295 7.181 0.251 7.3772 0.194193 7.58838C0.137386 7.79956 0.127441 8.0206 0.165055 8.23603L0.546055 10.426C0.636851 10.9481 0.909017 11.4214 1.31459 11.7625C1.72017 12.1036 2.23312 12.2906 2.76305 12.2905H3.15756C3.60755 13.06 4.18956 13.7575 4.87505 14.3635L3.78155 18.079C3.74867 18.1909 3.74233 18.3089 3.76302 18.4236C3.78372 18.5384 3.83089 18.6467 3.90078 18.7401C3.97067 18.8334 4.06136 18.9092 4.16565 18.9613C4.26994 19.0135 4.38495 19.0406 4.50155 19.0405H7.50156C7.65631 19.0405 7.80728 18.9927 7.93376 18.9035C8.06025 18.8144 8.15606 18.6883 8.20806 18.5425L8.93106 16.516C9.88356 16.7755 10.8961 16.9165 11.9476 16.9165C13.0081 16.9165 14.0296 16.774 14.9896 16.5085L15.8041 18.5665C15.8594 18.7064 15.9555 18.8263 16.0799 18.9108C16.2043 18.9954 16.3512 19.0406 16.5016 19.0405H19.5016C19.6186 19.0404 19.734 19.0129 19.8385 18.9602C19.943 18.9075 20.0337 18.8311 20.1034 18.7371C20.173 18.6431 20.2197 18.534 20.2397 18.4187C20.2598 18.3034 20.2525 18.185 20.2186 18.073L19.0771 14.314C20.7151 12.8425 21.7501 10.8385 21.7501 8.60353C21.7501 8.38603 21.7396 8.16853 21.7201 7.95703C22.1116 7.79203 22.4821 7.55803 22.7776 7.29103C23.2501 7.75003 24.0001 7.75003 24.0001 6.66553C24.0001 7.00003 23.2501 7.00003 23.3086 6.62653C23.3716 6.50612 23.417 6.37731 23.4436 6.24403C23.4788 6.07029 23.4695 5.89046 23.4166 5.72128C23.3636 5.55211 23.2686 5.3991 23.1406 5.27653C23.0055 5.1373 22.8277 5.04721 22.6356 5.02058C22.4434 4.99395 22.2479 5.03229 22.0801 5.12953C21.9257 5.21482 21.7941 5.33588 21.6962 5.48256C21.5983 5.62925 21.5371 5.79727 21.5176 5.97253C21.4816 6.33703 21.6406 6.69253 21.9976 6.95353C21.8737 7.03916 21.7438 7.11586 21.6091 7.18303C20.8081 3.18703 16.6831 0.290527 11.9461 0.290527ZM22.7056 6.10453C22.6788 6.21856 22.6288 6.32581 22.5586 6.41953C22.5361 6.40782 22.5141 6.39531 22.4926 6.38203C22.2736 6.24703 22.2571 6.11953 22.2646 6.04753C22.2719 5.99371 22.2916 5.94231 22.322 5.89731C22.3525 5.85231 22.3929 5.81492 22.4401 5.78803C22.5136 5.74753 22.5601 5.75653 22.6096 5.80603C22.6513 5.8423 22.6822 5.88928 22.6992 5.94189C22.7161 5.99451 22.7183 6.05075 22.7056 6.10453ZM9.20706 5.12953C9.11097 5.16213 9.00926 5.1749 8.9081 5.16706C8.80693 5.15921 8.70841 5.13092 8.61849 5.0839C8.52858 5.03688 8.44914 4.9721 8.38498 4.89348C8.32083 4.81487 8.2733 4.72405 8.24526 4.62653C8.21722 4.52901 8.20927 4.42682 8.22187 4.32613C8.23448 4.22545 8.26738 4.12837 8.31859 4.04077C8.3698 3.95318 8.43826 3.87688 8.51981 3.81651C8.60137 3.75613 8.69432 3.71293 8.79306 3.68953C9.81838 3.39653 10.8797 3.24859 11.9461 3.25003C13.0906 3.25003 14.1916 3.41503 15.2161 3.72253C15.3104 3.75079 15.3983 3.79737 15.4746 3.85959C15.551 3.92182 15.6143 3.99847 15.6611 4.08518C15.7078 4.17188 15.737 4.26694 15.747 4.36493C15.757 4.46292 15.7476 4.56192 15.7193 4.65628C15.691 4.75063 15.6445 4.8385 15.5822 4.91485C15.52 4.99121 15.4434 5.05456 15.3567 5.10129C15.27 5.14802 15.1749 5.17721 15.0769 5.18721C14.9789 5.1972 14.8799 5.18779 14.7856 5.15953C13.8639 4.88592 12.9074 4.74798 11.9461 4.75003C10.9861 4.75003 10.0636 4.88503 9.20706 5.13103V5.12953ZM7.50006 7.37503C7.50006 7.6734 7.38153 7.95954 7.17055 8.17052C6.95957 8.3815 6.67342 8.50003 6.37506 8.50003C6.07669 8.50003 5.79054 8.3815 5.57956 8.17052C5.36858 7.95954 5.25005 7.6734 5.25005 7.37503C5.25005 7.07666 5.36858 6.79051 5.57956 6.57953C5.79054 6.36855 6.07669 6.25003 6.37506 6.25003C6.67342 6.25003 6.95957 6.36855 7.17055 6.57953C7.38153 6.79051 7.50006 7.07666 7.50006 7.37503Z"
          fill="#707974"
        />
      </svg>
    ),
    activeIcon: (
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="20"
        viewBox="0 0 24 20"
        fill="none"
      >
        <path
          d="M11.9461 0.290527C7.48056 0.290527 3.58956 2.84653 2.46605 6.47803H1.64105C1.42237 6.47827 1.20638 6.52632 1.00822 6.61882C0.810064 6.71132 0.634528 6.84603 0.493911 7.01351C0.353295 7.181 0.251 7.3772 0.194193 7.58838C0.137386 7.79956 0.127441 8.0206 0.165055 8.23603L0.546055 10.426C0.636851 10.9481 0.909017 11.4214 1.31459 11.7625C1.72017 12.1036 2.23312 12.2906 2.76305 12.2905H3.15756C3.60755 13.06 4.18956 13.7575 4.87505 14.3635L3.78155 18.079C3.74867 18.1909 3.74233 18.3089 3.76302 18.4236C3.78372 18.5384 3.83089 18.6467 3.90078 18.7401C3.97067 18.8334 4.06136 18.9092 4.16565 18.9613C4.26994 19.0135 4.38495 19.0406 4.50155 19.0405H7.50156C7.65631 19.0405 7.80728 18.9927 7.93376 18.9035C8.06025 18.8144 8.15606 18.6883 8.20806 18.5425L8.93106 16.516C9.88356 16.7755 10.8961 16.9165 11.9476 16.9165C13.0081 16.9165 14.0296 16.774 14.9896 16.5085L15.8041 18.5665C15.8594 18.7064 15.9555 18.8263 16.0799 18.9108C16.2043 18.9954 16.3512 19.0406 16.5016 19.0405H19.5016C19.6186 19.0404 19.734 19.0129 19.8385 18.9602C19.943 18.9075 20.0337 18.8311 20.1034 18.7371C20.173 18.6431 20.2197 18.534 20.2397 18.4187C20.2598 18.3034 20.2525 18.185 20.2186 18.073L19.0771 14.314C20.7151 12.8425 21.7501 10.8385 21.7501 8.60353C21.7501 8.38603 21.7396 8.16853 21.7201 7.95703C22.1116 7.79203 22.4821 7.55803 22.7776 7.29103C23.2501 7.75003 24.0001 7.75003 24.0001 6.66553C24.0001 7.00003 23.2501 7.00003 23.3086 6.62653C23.3716 6.50612 23.417 6.37731 23.4436 6.24403C23.4788 6.07029 23.4695 5.89046 23.4166 5.72128C23.3636 5.55211 23.2686 5.3991 23.1406 5.27653C23.0055 5.1373 22.8277 5.04721 22.6356 5.02058C22.4434 4.99395 22.2479 5.03229 22.0801 5.12953C21.9257 5.21482 21.7941 5.33588 21.6962 5.48256C21.5983 5.62925 21.5371 5.79727 21.5176 5.97253C21.4816 6.33703 21.6406 6.69253 21.9976 6.95353C21.8737 7.03916 21.7438 7.11586 21.6091 7.18303C20.8081 3.18703 16.6831 0.290527 11.9461 0.290527ZM22.7056 6.10453C22.6788 6.21856 22.6288 6.32581 22.5586 6.41953C22.5361 6.40782 22.5141 6.39531 22.4926 6.38203C22.2736 6.24703 22.2571 6.11953 22.2646 6.04753C22.2719 5.99371 22.2916 5.94231 22.322 5.89731C22.3525 5.85231 22.3929 5.81492 22.4401 5.78803C22.5136 5.74753 22.5601 5.75653 22.6096 5.80603C22.6513 5.8423 22.6822 5.88928 22.6992 5.94189C22.7161 5.99451 22.7183 6.05075 22.7056 6.10453ZM9.20706 5.12953C9.11097 5.16213 9.00926 5.1749 8.9081 5.16706C8.80693 5.15921 8.70841 5.13092 8.61849 5.0839C8.52858 5.03688 8.44914 4.9721 8.38498 4.89348C8.32083 4.81487 8.2733 4.72405 8.24526 4.62653C8.21722 4.52901 8.20927 4.42682 8.22187 4.32613C8.23448 4.22545 8.26738 4.12837 8.31859 4.04077C8.3698 3.95318 8.43826 3.87688 8.51981 3.81651C8.60137 3.75613 8.69432 3.71293 8.79306 3.68953C9.81838 3.39653 10.8797 3.24859 11.9461 3.25003C13.0906 3.25003 14.1916 3.41503 15.2161 3.72253C15.3104 3.75079 15.3983 3.79737 15.4746 3.85959C15.551 3.92182 15.6143 3.99847 15.6611 4.08518C15.7078 4.17188 15.737 4.26694 15.747 4.36493C15.757 4.46292 15.7476 4.56192 15.7193 4.65628C15.691 4.75063 15.6445 4.8385 15.5822 4.91485C15.52 4.99121 15.4434 5.05456 15.3567 5.10129C15.27 5.14802 15.1749 5.17721 15.0769 5.18721C14.9789 5.1972 14.8799 5.18779 14.7856 5.15953C13.8639 4.88592 12.9074 4.74798 11.9461 4.75003C10.9861 4.75003 10.0636 4.88503 9.20706 5.13103V5.12953ZM7.50006 7.37503C7.50006 7.6734 7.38153 7.95954 7.17055 8.17052C6.95957 8.3815 6.67342 8.50003 6.37506 8.50003C6.07669 8.50003 5.79054 8.3815 5.57956 8.17052C5.36858 7.95954 5.25005 7.6734 5.25005 7.37503C5.25005 7.07666 5.36858 6.79051 5.57956 6.57953C5.79054 6.36855 6.07669 6.25003 6.37506 6.25003C6.67342 6.25003 6.95957 6.36855 7.17055 6.57953C7.38153 6.79051 7.50006 7.07666 7.50006 7.37503Z"
          fill="#1CA380"
        />
      </svg>
    ),
  },
  {
    path: "/add-expense",
    label: "Add",
    icon: <Icon icon="zi-plus" />,
    activeIcon: <Icon icon="zi-plus" />,
  },
  {
    path: "/profile",
    label: "Profile",
    icon: <Icon icon="zi-user-circle" />,
    activeIcon: <Icon icon="zi-user-circle-solid" />,
  },
];

function NavigationBar() {
  const navigate = useNavigate();
  const location = useLocation();
  const [activeTab, setActiveTab] = useState("/");
  const pathname = location.pathname.split("/")[1];

  useEffect(() => {
    if (navItems.find((item) => item.path === location.pathname)) {
      setActiveTab(location.pathname);
    }
  }, [location]);

  const handleChangeRoute = (key) => {
    setActiveTab(key);
    navigate(key, { animate: false });
  };
  return (
    IsShowNavbar(location.pathname) && (
      <BottomNavigation
        id="bottom-nav"
        activeKey={activeTab}
        onChange={(key) => handleChangeRoute(key)}
      >
        {navItems.map(({ path, label, icon, activeIcon }) => (
          <BottomNavigation.Item
            key={path}
            label={label}
            icon={icon}
            activeIcon={activeIcon}
          />
        ))}
      </BottomNavigation>
    )
  );
}

export default NavigationBar;
function IsShowNavbar(path: string) {
  const listNotAllowPaths: string[] = ["/", "/edit-profile"];
  if (path == "/") return false;
  if (listNotAllowPaths.includes(path)) {
    return false;
  }
  return true;
}
